{"version":3,"sources":["controller/picker.ts","views/sub-views/PickerCol.tsx","views/Picker.tsx","views/PickerView.tsx","site/pages/picker/index.js","../node_modules/@babel/runtime/helpers/esm/classCallCheck.js","../node_modules/@babel/runtime/helpers/esm/createClass.js","controller/event.ts","views/Transition.tsx","views/Sheet.tsx"],"names":["PickerControl","index","maxIdx","colStyle","LINE_HEIGHT","curY","oldY","isAnm","this","translateY","transition","adjustTranslate","adjustTranIdx","curTransLateY","maxTranslate","curPickIdx","Math","abs","round","e","getEventPoint","pageY","getFinallyTranslate","PickerCol","colRef","list","value","onChange","pickControl","findIndex","val","length","initPickerControl","useState","setColStyle","onStartHandler","onStart","onMoveHandler","stopPropagation","preventDefault","onMove","onEndHandler","onEnd","useEffect","eventControl","EventControl","createEventList","listenerAllOfEle","removeAllOfEle","className","ref","ele","style","transform","map","item","key","label","Picker","data","values","pickValues","setValues","colChangeHandler","idx","pickIdx","oldState","splice","pickerClassName","PickerView","props","indexes","pickObj","setValue","Sheet","ensureHandler","onEnsure","button","Button","TestPicker","values1","setValues1","values2","setValues2","textAlign","margin","console","log","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","i","descriptor","enumerable","configurable","writable","Object","defineProperty","_createClass","protoProps","staticProps","prototype","eventList","willPreventDefault","willNotPreventDefault","$ele","isPassiveSupported","passiveSupported","passive","start","move","end","touchstart","mousedown","touchmove","mousemove","touchend","mouseup","keys","forEach","pd","indexOf","addEventListener","removeEventListener","Transition","name","isShow","children","time","initName","transitionName","setName","isConShow","setConShow","setTimeout","React","Children","child","childTs","cloneElement","setIsShow","closeSheet","onClick","header","titleTxt"],"mappings":"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","file":"static/js/2.147871f5.chunk.js","sourcesContent":["import { TouchEvent, MouseEvent } from 'react';\nimport { getEventPoint } from '../utils/base';\n\ntype PickerEvent = TouchEvent<HTMLDivElement> | MouseEvent<HTMLDivElement>;\n\nclass PickerControl {\n    colStyle: {\n        translateY: number,\n        transition: string\n    };\n    LINE_HEIGHT: number;\n    maxIdx: number\n    curY: number;\n    oldY: number;\n    isAnm: boolean;\n\n    constructor(index: number, maxIdx: number) {\n        this.LINE_HEIGHT = 26;\n        this.maxIdx = maxIdx\n        this.colStyle = {\n            translateY: - (index * this.LINE_HEIGHT),\n            transition: 'none',\n        }\n        this.curY = 0;\n        this.oldY = 0;\n        this.isAnm = false;\n    }\n\n    getFinallyTranslate() {\n        let adjustTranslate, adjustTranIdx;\n        const curTransLateY = this.colStyle.translateY;\n        const maxTranslate = - this.maxIdx * this.LINE_HEIGHT;\n\n        if (curTransLateY > 0) {\n            adjustTranslate = 0;\n            adjustTranIdx = 0;\n        } else if (curTransLateY < maxTranslate) {\n            adjustTranslate = maxTranslate;\n            adjustTranIdx = this.maxIdx;\n        } else {\n            const curPickIdx = Math.abs(Math.round(curTransLateY / this.LINE_HEIGHT));\n            adjustTranslate = - curPickIdx * this.LINE_HEIGHT;\n            adjustTranIdx = curPickIdx;\n        }\n\n        return { adjustTranIdx, adjustTranslate };\n    }\n\n    onStart(e: PickerEvent) {\n        this.curY = getEventPoint(e).pageY;\n        this.oldY = this.colStyle.translateY;\n        this.isAnm = true;\n    }\n\n    onMove(e: PickerEvent) {\n        if (this.isAnm) {\n            const translateY = getEventPoint(e).pageY - this.curY;\n            this.colStyle = {\n                translateY: translateY + this.oldY,\n                transition: 'none'\n            };\n        }\n    }\n\n    onEnd(): number {\n        this.isAnm = false;\n        const { adjustTranIdx, adjustTranslate } = this.getFinallyTranslate();\n        this.colStyle = {\n            translateY: adjustTranslate,\n            transition: 'all 0.3s'\n        }\n        return adjustTranIdx;\n    }\n}\n\nexport default PickerControl;","import React, { useState, useEffect, TouchEvent, MouseEvent } from 'react';\nimport PickerControl from '../../controller/picker';\n\nimport EventControl from '../../controller/event';\n\ninterface PickerColProps {\n    list: Array<any>,\n    value: ValueType,\n    onChange?: Function\n}\n\ntype ValueType = string | number;\ntype PickerEvent = TouchEvent<HTMLDivElement> | MouseEvent<HTMLDivElement>;\n\nexport default function PickerCol({list, value, onChange}: PickerColProps) {\n\n    let colRef: HTMLDivElement | null;\n\n    function initPickerControl (list: Array<any>, value: ValueType) {\n        let index = list.findIndex(val => val.value === value);\n        index = index === -1 ? 0 : index;\n        return new PickerControl(index, list.length-1);\n    }\n\n    const pickControl = initPickerControl(list, value);\n    const [colStyle, setColStyle] = useState(pickControl.colStyle)\n\n    const onStartHandler = (e: PickerEvent) => {\n        pickControl.onStart(e);\n    }\n\n    const onMoveHandler = (e: PickerEvent) => {\n        e.stopPropagation();\n        e.preventDefault();\n        pickControl.onMove(e);\n        setColStyle(pickControl.colStyle);\n    }\n\n    const onEndHandler = (e: PickerEvent) => {\n        const adjustTranIdx = pickControl.onEnd();\n        setColStyle(pickControl.colStyle);\n        const value = list[adjustTranIdx].value;\n        if (typeof onChange === 'function') {\n            onChange(value)\n        }\n    }\n    \n    useEffect(() => {\n        const eventControl = new EventControl(colRef as HTMLDivElement);\n        eventControl.createEventList(onStartHandler, onMoveHandler, onEndHandler);\n        eventControl.listenerAllOfEle();\n        return () => {\n            eventControl.removeAllOfEle();\n        }\n    }, [])\n\n    return <div className=\"zui-picker-col\">\n        <div\n            className=\"zui-picker-col-mask\"\n            ref={ele => colRef = ele}>\n        </div>\n        <div\n            className=\"zui-picker-col-area\"\n            style={{\n                transition: colStyle.transition,\n                transform: `translateY(${colStyle.translateY}px)`,\n            }}>\n            {\n                list.map(item=> <div className=\"zui-picker-item\"\n                    key={item.value}>{item.label}</div>)\n            }\n        </div>\n    </div>\n}","import React, { useState } from 'react';\nimport PickerCol from './sub-views/PickerCol';\n\n// import { typeCheck } from '../utils/base';\n\nexport interface PickerProps {\n    data: Array<Array<{[key: string]: string}>>,\n    values: Array<string | number>,\n    className?: string,\n    onChange?: Function\n}\n\nfunction Picker({data, values, className, onChange}: PickerProps) {\n\n    const [pickValues, setValues] = useState(['', '']);\n\n    // if (typeCheck([\n    //     ['data', data, 'Array'],\n    //     ['values', values, 'Array'],\n    //     ['className', className, 'String', 'Undefined', 'Null'],\n    //     ['onChange', onChange, 'Function', 'Undefined', 'Null']\n    // ])) return null;\n\n    const colChangeHandler = (idx: number) => (value: string, pickIdx: number) => {\n        setValues((oldState) => {\n            oldState.splice(idx, 1, value);\n            return oldState;\n        })\n        onChange && onChange(pickValues);\n    }\n\n    const pickerClassName = `zui-picker ${className || ''}`\n\n    return <div className={pickerClassName}>\n        {\n            data.map((list, idx) => <PickerCol\n                key={idx}\n                value={values[idx]}\n                list={list}\n                onChange={colChangeHandler(idx)}\n            ></PickerCol>)\n        }\n    </div>\n}\n\nexport default Picker;","import React, { useState } from 'react';\n\nimport Sheet from './Sheet';\nimport Button from './Button';\nimport Picker from './Picker'\n\ninterface PickerViewProps {\n    data: Array<Array<{[key: string]: string}>>,\n    values: Array<string | number>,\n    onChange?: Function,\n    onEnsure?: Function\n}\n\ninterface GlobalAttr {\n    values: Array<string>,\n    indexes: Array<number>\n}\n\nfunction PickerView(props: PickerViewProps) {\n\n    const [pickObj, setValue] = useState({values: [], indexes: []} as GlobalAttr);\n\n    const ensureHandler = () => {\n        if (typeof props.onEnsure === 'function') {\n            props.onEnsure(pickObj.values, pickObj.indexes)\n        }\n    }\n\n    const changeHandler = (values: Array<string>, indexes: Array<number>) => {\n        setValue({ values, indexes });\n        if (typeof props.onChange === 'function') {\n            props.onChange(values, indexes)\n        }\n    }\n\n    return <Sheet\n        ensureHandler={ensureHandler}\n        button={<Button>弹出Picker</Button>}>\n        <Picker\n            className=\"zui-picker-view\"\n            data={props.data}\n            values={props.values}\n            onChange={changeHandler}\n        ></Picker>\n    </Sheet>\n}\n\nexport default PickerView;","import React, { useState } from 'react';\n\nimport Picker from '../../../views/Picker';\nimport PickerView from '../../../views/PickerView';\n\nconst data = [\n    [\n        {\n            value: '1',\n            label: 'test1'\n        },{\n            value: '2',\n            label: 'test2'\n        },{\n            value: '3',\n            label: 'test3'\n        },{\n            value: '4',\n            label: 'test4'\n        },{\n            value: '5',\n            label: 'test5'\n        },\n    ], [\n        {\n            value: '11',\n            label: '测试1'\n        },{\n            value: '22',\n            label: '测试2'\n        },{\n            value: '33',\n            label: '测试3'\n        },{\n            value: '44',\n            label: '测试4'\n        },{\n            value: '55',\n            label: '测试5'\n        },\n    ]\n]\n\n\nconst TestPicker = () => {\n\n    const [values1, setValues1] = useState(['2', '44']);\n    const [values2, setValues2] = useState(['3', '22']);\n\n\n    const changeHandler = (values) => {\n        setValues1(values);\n        console.log(values);\n    }\n\n    const changeHandler2 = (values) => {\n        setValues2(values);\n        console.log(values);\n    }\n\n    const ensureHandler = (values) => {\n        console.log(values);\n    }\n\n    return <div>\n        <div style={{textAlign: 'center', margin: '33px 0'}}>\n            <p>使用了 touch 事件</p>\n            <p>需使用手机模式</p>\n        </div>\n        <Picker\n            data={data}\n            values={values1}\n            onChange={changeHandler}>\n        </Picker>\n        <br></br>\n        <PickerView\n            data={data}\n            values={values2}\n            onChange={changeHandler2}\n            onEnsure={ensureHandler}>\n        </PickerView>\n    </div>\n}\n\nexport default TestPicker;","export default function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}","import { passiveSupported } from \"../utils/base\";\n\nclass EventControl {\n    \n    eventList: {[key: string]: Function};\n    willPreventDefault: object | boolean;\n    willNotPreventDefault: object | boolean;\n    $ele: HTMLDivElement;\n\n    constructor(ele: HTMLDivElement) {\n        this.eventList = {};\n        const isPassiveSupported = passiveSupported();\n        this.willPreventDefault = isPassiveSupported ? { passive: false } : false;\n        this.willNotPreventDefault = isPassiveSupported ? { passive: true } : false;\n        this.$ele = ele;\n    }\n\n    createEventList(start: Function, move: Function, end: Function) {\n        this.eventList =  {\n            touchstart: start,\n            mousedown: start,\n            touchmove: move,\n            mousemove: move,\n            touchend: end,\n            mouseup: end,\n        }\n    }\n\n    listenerAllOfEle() {\n        Object.keys(this.eventList).forEach(key => {\n            const pd = key.indexOf('move') >= 0 ? this.willPreventDefault : this.willNotPreventDefault;\n            this.$ele.addEventListener(key, this.eventList[key] as any, pd as any);\n        })\n    }\n\n    removeAllOfEle() {\n        Object.keys(this.eventList).forEach(key => {\n            this.$ele.removeEventListener(key, this.eventList[key] as any);\n        })\n    }\n}\n\nexport default EventControl;\n","import React, {useState, useEffect} from 'react';\n\ninterface TransitionProps {\n    name: string,\n    isShow: boolean,\n    children: React.ReactNode,\n    time?: number\n}\n\nexport default function Transition({name, isShow, children, time = 300}: TransitionProps) {\n\n    const initName = name || '';\n\n    const [transitionName, setName] = useState('');\n    const [isConShow, setConShow] = useState(false);\n\n    useEffect(() => {\n        if (isShow) {\n            setConShow(true);\n            setTimeout(() => {\n                setName(`${initName}--in`);\n            }, 34); // 下两帧\n        }\n        return () => {\n            // 当销毁时 设置 class 为 out\n            if (!isConShow && isShow) {\n                setName(`${initName}--out`);\n                // 正常关闭\n                setTimeout(() => {\n                    setConShow(false);\n                    setName('');\n                }, time);\n                // TODO\n                // 也可以通过 transitionEnd 来计算结束时间\n                // 但是如果没有设置动画效果那么怎么办？\n                // 如何判断是否有动画效果？\n            }\n        }\n    }, [isShow])\n\n    return <>\n        {\n            isConShow ?\n                React.Children.map(children, (child) => {\n                    const childTs = child as React.DetailedReactHTMLElement<any, HTMLElement>;\n                    return React.cloneElement(childTs,\n                        {\n                            className:  `${childTs.props.className} ${transitionName}`,\n                        },\n                        // children // 外包裹\n                    )\n                })\n                : null\n        }\n    </>\n}\n","import React, { useState, ReactNode, MouseEvent } from 'react';\nimport Transition from './Transition';\n\ninterface SheetProps {\n    children: ReactNode,\n    button: ReactNode, // 触发Sheet的按钮\n    header?: ReactNode,\n    titleTxt?: string,\n    canModalClose?: boolean,\n    ensureHandler?: Function\n}\n\nexport default  function Sheet(props: SheetProps) {\n    const [isShow, setIsShow] = useState(false);\n\n    const modalHandler = () => {\n        setIsShow(false);\n    }\n\n    const closeSheet = () => {\n        setIsShow(false);\n    }\n\n    const clickHandler = (e: MouseEvent<HTMLElement>): void => {\n        // e.cancelBubble = true; // 阻止冒泡\n        e.stopPropagation(); // 阻止冒泡\n        if (typeof props.ensureHandler === 'function') {\n            props.ensureHandler();\n        }\n        closeSheet();\n    }\n\n    \n    return <>\n        <div onClick={() => setIsShow(true)}>{props.button}</div>\n        <Transition name=\"zui-sheet\" isShow={isShow}>\n            <div className='zui-sheet-box'>\n                <div className=\"zui-sheet-mask\" onClick={modalHandler}></div>\n                {/* sheet主体 */}\n                <div className=\"zui-sheet-area\">\n                    {/* 头部信息 */}\n                    {\n                        props.header ?\n                            props.header :\n                            <div className=\"zui-sheet-header\">\n                                <div onClick={closeSheet}>取消</div>\n                                <div>{props.titleTxt || ''}</div>\n                                <div onClick={clickHandler}>确定</div>\n                            </div>\n                    }\n                    {/* 内容部分 */}\n                    <div\n                        className=\"zui-sheet-body\"\n                    >{props.children}</div>\n                </div>\n            </div>\n        </Transition>\n    </>\n}\n"],"sourceRoot":""}