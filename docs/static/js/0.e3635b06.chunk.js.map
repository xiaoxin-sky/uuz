{"version":3,"sources":["controller/scroll.ts","views/Scroll.tsx","site/pages/scroll/index.js","../node_modules/@babel/runtime/helpers/esm/classCallCheck.js","../node_modules/@babel/runtime/helpers/esm/createClass.js","controller/event.ts","../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js","../node_modules/@babel/runtime/helpers/esm/typeof.js","../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js","../node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js","../node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","../node_modules/@babel/runtime/helpers/esm/inherits.js","controller/move.ts"],"names":["DistanceStatus","ScrollControl","direction","Refresh_Distance","distanceStatus","isRefreshable","this","EMPTY","x","y","tip","dist","getDist","DONE","HALF","MoveControl","Scroll","props","useState","scrollTip","setScrollTip","transform","transition","freshAreaStyle","setScrollAreaStyle","bottleneck","setBottleneck","scrollControl","refScrollArea","useRef","refScrollBody","freshBoxClassName","className","hideScrollTip","freshStore","freshHandler","setTimeout","onStartHandler","event","current","scrollTop","canRefresh","banRefresh","start","onMoveHandler","distanceY","move","markScrollTip","onEndHandler","status","getUpdateStatus","end","loadHandler","scrollEle","scrollHeight","useEffect","offsetHeight","eventControl","EventControl","createEventList","listenerAllOfEle","removeAllOfEle","ref","style","children","TestContent","Array","num","fill","map","val","idx","key","TestReFresh","setNum","console","log","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","_createClass","protoProps","staticProps","prototype","ele","eventList","willPreventDefault","willNotPreventDefault","$ele","isPassiveSupported","passiveSupported","passive","touchstart","mousedown","touchmove","mousemove","touchend","mouseup","keys","forEach","pd","indexOf","addEventListener","removeEventListener","_getPrototypeOf","o","setPrototypeOf","getPrototypeOf","__proto__","_typeof2","obj","Symbol","iterator","constructor","_typeof","_possibleConstructorReturn","self","call","ReferenceError","_setPrototypeOf","p","_inherits","subClass","superClass","create","value","zeroPoint","JSON","stringify","startPoint","distance","endPoint","Prevent_Distance","lockDirection","isAnm","parse","Error","absX","Math","abs","absY","stopPropagation","point","getEventPoint","pageX","pageY","preventDefault","assign","_getLockDirection","_getFinalEndPonit"],"mappings":"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","file":"static/js/0.e3635b06.chunk.js","sourcesContent":["import MoveControl from './move';\n\ntype Point = {\n    x: number,\n    y: number\n}\n\nenum DistanceStatus { 'EMPTY', 'HALF', 'DONE' }\n\ntype Status = 'update' | 'reset' | 'none';\n\nclass ScrollControl extends MoveControl {\n    \n    Refresh_Distance: number;\n    distanceStatus?: DistanceStatus;\n    isRefreshable: boolean;\n\n    constructor() {\n        super({direction: 'y'});\n        this.Refresh_Distance = 90;\n        this.isRefreshable = true;\n    }\n\n    _getFinalEndPonit(): Point {\n        this.distanceStatus = DistanceStatus.EMPTY;\n        return {\n            x: 0,\n            y: 0\n        };\n    }\n\n    banRefresh() {\n        this.isRefreshable = false;\n    }\n\n    canRefresh() {\n        this.isRefreshable = true;\n    }\n\n    markScrollTip(): string {\n        let tip = '';\n        const dist = this.getDist();\n        if (dist > this.Refresh_Distance) {\n            this.distanceStatus = DistanceStatus.DONE;\n            tip = '松开刷新';\n        } else if (dist > 0){\n            this.distanceStatus = DistanceStatus.HALF;\n            tip = '下拉刷新';\n        }\n        return tip;\n    }\n\n    getUpdateStatus(): Status {\n        if (this.distanceStatus === DistanceStatus.DONE) {\n            return 'update';\n        }\n        if (this.distanceStatus === DistanceStatus.HALF) {\n            return 'reset';\n        }\n        return 'none';\n    }\n\n}\n\nexport default ScrollControl;","import React, { useState, useEffect, useRef } from 'react';\nimport EventControl from '../controller/event';\nimport ScrollControl from '../controller/scroll';\n\ninterface ReScrollProps {\n  className?: String, // 刷新组件的 支持添加className\n  freshDistance?: number, // 触发刷新需要的：下拉距离\n  loadDistance?: number, // 触发加载需要的：距离最底部距离\n  freshHandler: Function | undefined, // 刷新执行的函数\n  loadHandler: Function | undefined // 加载执行的函数\n  children?: React.ReactNode\n}\n\ntype UseEvent = React.TouchEvent<HTMLDivElement> | React.MouseEvent<HTMLDivElement>;\n\nexport default function Scroll(props: ReScrollProps) {\n  const [scrollTip, setScrollTip] = useState('');\n  const [freshAreaStyle, setScrollAreaStyle] = useState({transform: '', transition: ''});\n  const [bottleneck, setBottleneck] = useState(0);\n  const [scrollControl] = useState(new ScrollControl());\n\n  let refScrollArea = useRef(null);\n  let refScrollBody = useRef(null);\n\n  let freshBoxClassName = `zui-scroll-box ${props.className || ''}`;\n  \n  const hideScrollTip = (): void => {\n    setScrollAreaStyle({\n      transform: `translate(0, -50px)`,\n      transition: 'transform 0.5s'\n    })\n  }\n  \n  const updateScroll = () => {\n    props.freshHandler!();\n    setScrollAreaStyle({\n      transform: `translate(0, 0)`,\n      transition: 'transform 2s'\n    })\n    setScrollTip('刷新中 >>>');\n    setTimeout(() => hideScrollTip(), 300);\n  }\n\n  const freshStore = {\n    'update': updateScroll,\n    'reset': hideScrollTip,\n    'none': () => {}\n  }\n\n  const onStartHandler = (event: UseEvent): void => {\n    setScrollAreaStyle({\n      transform: `translate(0, -50px)`,\n      transition: ''\n    })\n    if ((refScrollBody.current as any).scrollTop === 0) {\n      scrollControl.canRefresh()\n    } else {\n      scrollControl.banRefresh()\n    }\n    scrollControl.start(event);\n  }\n\n  const onMoveHandler = (event: UseEvent): void => {\n    const point = scrollControl.move(event);\n    const distanceY = point.y;\n    // 下拉动画\n    if (distanceY > 0 && scrollControl.isRefreshable) {\n      setScrollAreaStyle({\n        transform: `translate(0, ${distanceY - 50}px)`,\n        transition: ''\n      })\n      const tip = scrollControl.markScrollTip();\n      setScrollTip(tip);\n      return;\n    }\n  }\n\n  const onEndHandler = (): void => {\n    // 需要刷新的时候执行 传入的刷新方法\n    if (typeof props.freshHandler === 'function') {\n      const status = scrollControl.getUpdateStatus();\n      if (status !== 'none') {\n        freshStore[status]();\n        scrollControl.end();\n        return;\n      };\n    }\n\n    if (typeof props.loadHandler === 'function') {\n      const scrollEle = (refScrollBody.current as any);\n      if (scrollEle.scrollHeight < bottleneck + scrollEle.scrollTop) {\n        props.loadHandler();\n      }\n      return;\n    }\n  }\n\n  useEffect(() => {\n    setBottleneck((refScrollArea.current as any).offsetHeight + 500);\n  }, [])\n\n  useEffect(() => {\n    const eventControl = new EventControl(refScrollArea.current as any);\n    eventControl.createEventList(onStartHandler, onMoveHandler, onEndHandler);\n    eventControl.listenerAllOfEle();\n    return () => {\n        eventControl.removeAllOfEle();\n    }\n  })\n\n  return <div\n    className={freshBoxClassName}\n    ref={refScrollArea}>\n      {/* 滚动区域 */}\n      <div\n        className=\"zui-scroll-area\"\n        ref={refScrollBody}\n        style={freshAreaStyle}\n      >\n        {/* 刷新tip */}\n        <div className=\"zui-scroll-tip\">{scrollTip}</div>\n        {/* 真正的内容 */}\n        <div className=\"zui-scroll\">\n          {props.children}\n        </div>\n      </div>\n    </div>\n}\n","import React, { useState } from 'react';\n\nimport Scroll from '../../../views/Scroll'\n\nfunction TestContent(props) {\n    return Array(props.num).fill(0).map((val, idx) => {\n        return <div className=\"test-content\" key={idx}>{idx + 1}：需用手机模式测试</div>\n    })\n}\n\nfunction TestReFresh() {\n\n    const [num, setNum] = useState(50);\n\n    const freshHandler = () => {\n        console.log('刷新')\n        setNum(50)\n    }\n\n    const loadHandler = () => {\n        console.log('加载')\n        setNum(num + 30);\n    }\n\n    return <Scroll\n        className=\"test-fresh\"\n        freshHandler={freshHandler}\n        loadHandler={loadHandler}>\n        <TestContent num={num}></TestContent>\n    </Scroll>\n}\n\nexport default TestReFresh;","export default function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}","import { passiveSupported } from \"../utils/base\";\n\nclass EventControl {\n    \n    eventList: {[key: string]: Function};\n    willPreventDefault: object | boolean;\n    willNotPreventDefault: object | boolean;\n    $ele: HTMLDivElement;\n\n    constructor(ele: HTMLDivElement) {\n        this.eventList = {};\n        const isPassiveSupported = passiveSupported();\n        this.willPreventDefault = isPassiveSupported ? { passive: false } : false;\n        this.willNotPreventDefault = isPassiveSupported ? { passive: true } : false;\n        this.$ele = ele;\n    }\n\n    createEventList(start: Function, move: Function, end: Function) {\n        this.eventList =  {\n            touchstart: start,\n            mousedown: start,\n            touchmove: move,\n            mousemove: move,\n            touchend: end,\n            mouseup: end,\n        }\n    }\n\n    listenerAllOfEle() {\n        Object.keys(this.eventList).forEach(key => {\n            const pd = key.indexOf('move') >= 0 ? this.willPreventDefault : this.willNotPreventDefault;\n            this.$ele.addEventListener(key, this.eventList[key] as any, pd as any);\n        })\n    }\n\n    removeAllOfEle() {\n        Object.keys(this.eventList).forEach(key => {\n            this.$ele.removeEventListener(key, this.eventList[key] as any);\n        })\n    }\n}\n\nexport default EventControl;\n","export default function _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}","function _typeof2(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof2 = function _typeof2(obj) { return typeof obj; }; } else { _typeof2 = function _typeof2(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof2(obj); }\n\nexport default function _typeof(obj) {\n  if (typeof Symbol === \"function\" && _typeof2(Symbol.iterator) === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return _typeof2(obj);\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : _typeof2(obj);\n    };\n  }\n\n  return _typeof(obj);\n}","import _typeof from \"../../helpers/esm/typeof\";\nimport assertThisInitialized from \"./assertThisInitialized\";\nexport default function _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return assertThisInitialized(self);\n}","export default function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf\";\nexport default function _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}","import { getEventPoint } from \"../utils/base\";\n\ntype Point = {\n    x: number,\n    y: number\n}\n\ntype Direction = 'x' | 'y';\n\ntype UseEvent = React.TouchEvent<HTMLDivElement> | React.MouseEvent<HTMLDivElement>;\n\ninterface MoveControlProps {\n    direction?: Direction\n}\n\nconst zeroPoint = JSON.stringify({ x: 0, y: 0 });\n\nclass MoveControl {\n\n    startPoint: Point;\n    distance: Point;\n    endPoint: Point;\n    direction: Direction;\n    Prevent_Distance: number;\n    lockDirection: Direction | null;\n    isAnm: boolean;\n\n    constructor({direction = 'x'}: MoveControlProps) {\n        this.direction = direction;\n        this.startPoint = JSON.parse(zeroPoint);\n        this.distance = JSON.parse(zeroPoint);\n        this.endPoint = JSON.parse(zeroPoint);\n        this.Prevent_Distance = 5;\n        this.lockDirection = null;\n        this.isAnm = false;\n    }\n\n    // 终止时位置调整\n    _getFinalEndPonit(): Point {\n        throw Error('_getFinalEndPonit 需要被重写');\n    }\n\n    // 方向锁定\n    _getLockDirection(): Direction | null {\n        const absX = Math.abs(this.distance.x);\n        const absY = Math.abs(this.distance.y);\n\n        let lockDirection: Direction | null = null;\n\n        if (this.direction === 'x') {\n            if (absX >= absY && absX > this.Prevent_Distance) {\n                lockDirection = 'x';\n            } else if (absY > this.Prevent_Distance) {\n                lockDirection = 'y';\n            }\n        } else {\n            if (absY >= absX && absY > this.Prevent_Distance) {\n                lockDirection = 'y';\n            } else if (absX > this.Prevent_Distance) {\n                lockDirection = 'x';\n            }\n        }\n        \n        return lockDirection;\n    }\n\n    getDist() {\n        const dist = this.endPoint[this.direction] - this.distance[this.direction];\n        return dist;\n    }\n\n    start(event: UseEvent): void {\n        event.stopPropagation();\n        this.isAnm = true;\n        const point = getEventPoint(event);\n        this.lockDirection = null;\n        this.startPoint = {\n            x: point.pageX,\n            y: point.pageY\n        }\n    }\n\n    move(event: UseEvent): Point {\n        if (this.isAnm) {\n            event.stopPropagation();\n            const point = getEventPoint(event);\n            this.distance = {\n                x: this.startPoint.x - point.pageX,\n                y: this.startPoint.y - point.pageY,\n            }\n            if (!this.lockDirection) {\n                // event.preventDefault();\n                this.lockDirection = this._getLockDirection();\n            } else if (this.direction === this.lockDirection) {\n                event.preventDefault();\n                return Object.assign({x: 0, y: 0}, {[this.direction]: this.getDist()})\n            }\n        }\n        // 如果return movePoint 那么位置不变\n        return this.endPoint;\n    }\n\n    end(): Point {\n        this.isAnm = false;\n        return this._getFinalEndPonit();\n    }\n\n}\n\nexport default MoveControl;\n"],"sourceRoot":""}