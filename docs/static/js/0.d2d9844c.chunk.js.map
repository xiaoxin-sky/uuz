{"version":3,"sources":["controller/scroll.ts","views/Scroll.tsx","site/pages/scroll/index.js","../node_modules/@babel/runtime/helpers/esm/classCallCheck.js","../node_modules/@babel/runtime/helpers/esm/createClass.js","controller/event.ts","../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js","../node_modules/@babel/runtime/helpers/esm/typeof.js","../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js","../node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js","../node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","../node_modules/@babel/runtime/helpers/esm/inherits.js","controller/move.ts"],"names":["DistanceStatus","ScrollControl","direction","Refresh_Distance","distanceStatus","isRefreshable","this","EMPTY","x","y","tip","dist","getDist","DONE","HALF","MoveControl","Scroll","props","useState","scrollTip","setScrollTip","transform","transition","freshAreaStyle","setScrollAreaStyle","bottleneck","setBottleneck","scrollControl","bindFlag","setBindFlag","refScrollArea","useRef","refScrollBody","freshBoxClassName","className","hideScrollTip","freshStore","freshHandler","setTimeout","onStartHandler","event","current","scrollTop","canRefresh","banRefresh","start","console","log","onMoveHandler","distanceY","move","markScrollTip","onEndHandler","status","getUpdateStatus","end","loadHandler","scrollEle","scrollHeight","useEffect","offsetHeight","eventControl","EventControl","createEventList","listenerAllOfEle","removeAllOfEle","ref","style","children","TestContent","Array","num","fill","map","val","idx","key","TestReFresh","setNum","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","_createClass","protoProps","staticProps","prototype","ele","eventList","willPreventDefault","willNotPreventDefault","$ele","isPassiveSupported","passiveSupported","passive","touchstart","mousedown","touchmove","mousemove","touchend","mouseup","keys","forEach","pd","indexOf","addEventListener","removeEventListener","_getPrototypeOf","o","setPrototypeOf","getPrototypeOf","__proto__","_typeof2","obj","Symbol","iterator","constructor","_typeof","_possibleConstructorReturn","self","call","ReferenceError","_setPrototypeOf","p","_inherits","subClass","superClass","create","value","zeroPoint","JSON","stringify","startPoint","distance","endPoint","Prevent_Distance","lockDirection","isAnm","parse","Error","absX","Math","abs","absY","stopPropagation","point","getEventPoint","pageX","pageY","cancelable","preventDefault","assign","_getLockDirection","_getFinalEndPonit"],"mappings":"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","file":"static/js/0.d2d9844c.chunk.js","sourcesContent":["import MoveControl from './move';\n\ntype Point = {\n    x: number,\n    y: number\n}\n\nenum DistanceStatus { 'EMPTY', 'HALF', 'DONE' }\n\ntype Status = 'update' | 'reset' | 'none';\n\nclass ScrollControl extends MoveControl {\n    \n    Refresh_Distance: number;\n    distanceStatus?: DistanceStatus;\n    isRefreshable: boolean;\n\n    constructor() {\n        super({direction: 'y'});\n        this.Refresh_Distance = 90;\n        this.isRefreshable = true;\n    }\n\n    _getFinalEndPonit(): Point {\n        this.distanceStatus = DistanceStatus.EMPTY;\n        return {\n            x: 0,\n            y: 0\n        };\n    }\n\n    banRefresh() {\n        this.isRefreshable = false;\n    }\n\n    canRefresh() {\n        this.isRefreshable = true;\n    }\n\n    markScrollTip(): string {\n        let tip = '';\n        const dist = this.getDist();\n        if (dist > this.Refresh_Distance) {\n            this.distanceStatus = DistanceStatus.DONE;\n            tip = '松开刷新';\n        } else if (dist > 0){\n            this.distanceStatus = DistanceStatus.HALF;\n            tip = '下拉刷新';\n        }\n        return tip;\n    }\n\n    getUpdateStatus(): Status {\n        if (this.distanceStatus === DistanceStatus.DONE) {\n            return 'update';\n        }\n        if (this.distanceStatus === DistanceStatus.HALF) {\n            return 'reset';\n        }\n        return 'none';\n    }\n\n}\n\nexport default ScrollControl;","import React, { useState, useEffect, useRef } from 'react';\nimport EventControl from '../controller/event';\nimport ScrollControl from '../controller/scroll';\n\ninterface ReScrollProps {\n  className?: String, // 刷新组件的 支持添加className\n  freshDistance?: number, // 触发刷新需要的：下拉距离\n  loadDistance?: number, // 触发加载需要的：距离最底部距离\n  freshHandler: Function | undefined, // 刷新执行的函数\n  loadHandler: Function | undefined // 加载执行的函数\n  children?: React.ReactNode\n}\n\ntype UseEvent = React.TouchEvent<HTMLDivElement> | React.MouseEvent<HTMLDivElement>;\n\nexport default function Scroll(props: ReScrollProps) {\n  const [scrollTip, setScrollTip] = useState('');\n  const [freshAreaStyle, setScrollAreaStyle] = useState({transform: '', transition: ''});\n  const [bottleneck, setBottleneck] = useState(0);\n  const [scrollControl] = useState(new ScrollControl());\n  const [bindFlag, setBindFlag] = useState(0);\n\n  let refScrollArea = useRef(null);\n  let refScrollBody = useRef(null);\n\n  let freshBoxClassName = `zui-scroll-box ${props.className || ''}`;\n  \n  const hideScrollTip = (): void => {\n    setScrollAreaStyle({\n      transform: `translate(0, -50px)`,\n      transition: 'transform 0.5s'\n    })\n  }\n  \n  const updateScroll = () => {\n    props.freshHandler!();\n    setBindFlag(bindFlag + 1);\n    setScrollAreaStyle({\n      transform: `translate(0, 0)`,\n      transition: 'transform 2s'\n    })\n    setScrollTip('刷新中 >>>');\n    setTimeout(() => hideScrollTip(), 300);\n  }\n\n  const freshStore = {\n    'update': updateScroll,\n    'reset': hideScrollTip,\n    'none': () => {}\n  }\n\n  const onStartHandler = (event: UseEvent): void => {\n    setScrollAreaStyle({\n      transform: `translate(0, -50px)`,\n      transition: ''\n    })\n    if ((refScrollBody.current as any).scrollTop === 0) {\n      scrollControl.canRefresh()\n    } else {\n      scrollControl.banRefresh()\n    }\n    scrollControl.start(event);\n    console.log('点击')\n  }\n\n  const onMoveHandler = (event: UseEvent): void => {\n    const point = scrollControl.move(event);\n    const distanceY = point.y;\n    // 下拉动画\n    if (distanceY > 0 && scrollControl.isRefreshable) {\n      setScrollAreaStyle({\n        transform: `translate(0, ${distanceY - 50}px)`,\n        transition: ''\n      })\n      const tip = scrollControl.markScrollTip();\n      setScrollTip(tip);\n    }\n    console.log(distanceY, '移动')\n  }\n\n  const onEndHandler = (): void => {\n    // 需要刷新的时候执行 传入的刷新方法\n    if (typeof props.freshHandler === 'function') {\n      const status = scrollControl.getUpdateStatus();\n      if (status !== 'none') {\n        freshStore[status]();\n        scrollControl.end();\n        return;\n      };\n    }\n\n    if (typeof props.loadHandler === 'function') {\n      const scrollEle = (refScrollBody.current as any);\n      console.log(bottleneck, 'bottleneck')\n      if (scrollEle.scrollHeight < bottleneck + scrollEle.scrollTop) {\n        props.loadHandler();\n        setBindFlag(bindFlag + 1);\n      }\n    }\n  }\n\n  useEffect(() => {\n    setBottleneck((refScrollArea.current as any).offsetHeight + 500);\n    setBindFlag(bindFlag + 1);\n  }, [])\n\n  useEffect(() => {\n    const eventControl = new EventControl(refScrollArea.current as any);\n    eventControl.createEventList(onStartHandler, onMoveHandler, onEndHandler);\n    eventControl.listenerAllOfEle();\n    return () => {\n        eventControl.removeAllOfEle();\n    }\n  }, [bindFlag])\n\n  return <div\n    className={freshBoxClassName}\n    ref={refScrollArea}>\n      {/* 滚动区域 */}\n      <div\n        className=\"zui-scroll-area\"\n        ref={refScrollBody}\n        style={freshAreaStyle}\n      >\n        {/* 刷新tip */}\n        <div className=\"zui-scroll-tip\">{scrollTip}</div>\n        {/* 真正的内容 */}\n        <div className=\"zui-scroll\">\n          {props.children}\n        </div>\n      </div>\n    </div>\n}\n","import React, { useState } from 'react';\n\nimport Scroll from '../../../views/Scroll'\n\nfunction TestContent(props) {\n    return Array(props.num).fill(0).map((val, idx) => {\n        return <div className=\"test-content\" key={idx}>{idx + 1}：需用手机模式测试</div>\n    })\n}\n\nfunction TestReFresh() {\n\n    const [num, setNum] = useState(50);\n\n    const freshHandler = () => {\n        console.log('刷新')\n        setNum(50)\n    }\n\n    const loadHandler = () => {\n        console.log('加载')\n        setNum(num + 30);\n    }\n\n    return <Scroll\n        className=\"test-fresh\"\n        freshHandler={freshHandler}\n        loadHandler={loadHandler}>\n        <TestContent num={num}></TestContent>\n    </Scroll>\n}\n\nexport default TestReFresh;","export default function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}","import { passiveSupported } from \"../utils/base\";\n\nclass EventControl {\n    \n    eventList: {[key: string]: Function};\n    willPreventDefault: object | boolean;\n    willNotPreventDefault: object | boolean;\n    $ele: HTMLDivElement;\n\n    constructor(ele: HTMLDivElement) {\n        this.eventList = {};\n        const isPassiveSupported = passiveSupported();\n        this.willPreventDefault = isPassiveSupported ? { passive: false } : false;\n        this.willNotPreventDefault = isPassiveSupported ? { passive: true } : false;\n        this.$ele = ele;\n    }\n\n    createEventList(start: Function, move: Function, end: Function) {\n        this.eventList =  {\n            touchstart: start,\n            mousedown: start,\n            touchmove: move,\n            mousemove: move,\n            touchend: end,\n            mouseup: end,\n        }\n    }\n\n    listenerAllOfEle() {\n        Object.keys(this.eventList).forEach(key => {\n            const pd = key.indexOf('move') >= 0 ? this.willPreventDefault : this.willNotPreventDefault;\n            this.$ele.addEventListener(key, this.eventList[key] as any, pd as any);\n        })\n    }\n\n    removeAllOfEle() {\n        Object.keys(this.eventList).forEach(key => {\n            this.$ele.removeEventListener(key, this.eventList[key] as any);\n        })\n    }\n}\n\nexport default EventControl;\n","export default function _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}","function _typeof2(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof2 = function _typeof2(obj) { return typeof obj; }; } else { _typeof2 = function _typeof2(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof2(obj); }\n\nexport default function _typeof(obj) {\n  if (typeof Symbol === \"function\" && _typeof2(Symbol.iterator) === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return _typeof2(obj);\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : _typeof2(obj);\n    };\n  }\n\n  return _typeof(obj);\n}","import _typeof from \"../../helpers/esm/typeof\";\nimport assertThisInitialized from \"./assertThisInitialized\";\nexport default function _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return assertThisInitialized(self);\n}","export default function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf\";\nexport default function _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}","import { getEventPoint } from \"../utils/base\";\n\ntype Point = {\n    x: number,\n    y: number\n}\n\ntype Direction = 'x' | 'y';\n\ntype UseEvent = React.TouchEvent<HTMLDivElement> | React.MouseEvent<HTMLDivElement>;\n\ninterface MoveControlProps {\n    direction?: Direction\n}\n\nconst zeroPoint = JSON.stringify({ x: 0, y: 0 });\n\nclass MoveControl {\n\n    startPoint: Point;\n    distance: Point;\n    endPoint: Point;\n    direction: Direction;\n    Prevent_Distance: number;\n    lockDirection: Direction | null;\n    isAnm: boolean;\n\n    constructor({direction = 'x'}: MoveControlProps) {\n        this.direction = direction;\n        this.startPoint = JSON.parse(zeroPoint);\n        this.distance = JSON.parse(zeroPoint);\n        this.endPoint = JSON.parse(zeroPoint);\n        this.Prevent_Distance = 5;\n        this.lockDirection = null;\n        this.isAnm = false;\n    }\n\n    // 终止时位置调整\n    _getFinalEndPonit(): Point {\n        throw Error('_getFinalEndPonit 需要被重写');\n    }\n\n    // 方向锁定\n    _getLockDirection(): Direction | null {\n        const absX = Math.abs(this.distance.x);\n        const absY = Math.abs(this.distance.y);\n\n        let lockDirection: Direction | null = null;\n\n        if (this.direction === 'x') {\n            if (absX >= absY && absX > this.Prevent_Distance) {\n                lockDirection = 'x';\n            } else if (absY > this.Prevent_Distance) {\n                lockDirection = 'y';\n            }\n        } else {\n            if (absY >= absX && absY > this.Prevent_Distance) {\n                lockDirection = 'y';\n            } else if (absX > this.Prevent_Distance) {\n                lockDirection = 'x';\n            }\n        }\n        \n        return lockDirection;\n    }\n\n    getDist() {\n        const dist = this.endPoint[this.direction] - this.distance[this.direction];\n        return dist;\n    }\n\n    start(event: UseEvent): void {\n        event.stopPropagation();\n        this.isAnm = true;\n        const point = getEventPoint(event);\n        this.lockDirection = null;\n        this.startPoint = {\n            x: point.pageX,\n            y: point.pageY\n        }\n    }\n\n    move(event: UseEvent): Point {\n        if (this.isAnm) {\n            event.stopPropagation();\n            const point = getEventPoint(event);\n            this.distance = {\n                x: this.startPoint.x - point.pageX,\n                y: this.startPoint.y - point.pageY,\n            }\n            if (!this.lockDirection) {\n                // if (event.cancelable) {\n                //     event.preventDefault();\n                // }\n                this.lockDirection = this._getLockDirection();\n            } else if (this.direction === this.lockDirection) {\n                if (event.cancelable) {\n                    event.preventDefault();\n                }\n                return Object.assign({x: 0, y: 0}, {[this.direction]: this.getDist()})\n            }\n        }\n        // 如果return movePoint 那么位置不变\n        return this.endPoint;\n    }\n\n    end(): Point {\n        this.isAnm = false;\n        return this._getFinalEndPonit();\n    }\n\n}\n\nexport default MoveControl;\n"],"sourceRoot":""}