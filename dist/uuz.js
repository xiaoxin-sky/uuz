!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((e=e||self).uuz={})}(this,(function(e){"use strict";const n=Symbol("Text"),t={ELEMENT:1,STATEFUL_COMPONENT:4,TEXT_CHILDREN:8,ARRAY_CHILDREN:16},o=e=>"string"==typeof e?t.ELEMENT:t.STATEFUL_COMPONENT,l=[];let c=null;function r(e,n=null,l=null,c=0,r=null,u=!1){const s={el:null,component:null,key:n&&n.key||null,type:e,props:n,children:l,shapeFlag:o(e)};return Array.isArray(l)?s.shapeFlag|=t.ARRAY_CHILDREN:"string"==typeof l&&(s.shapeFlag|=t.TEXT_CHILDREN),s}const u=[],s=Promise.resolve();let i=!1;function f(e){return e?s.then(e):s}function a(e){u.includes(e)||(u.push(e),function(){if(i)return;i=!0,f(p)}())}function p(){let e;for(i=!1;e=u.shift();)e&&e()}let d,h=new WeakMap;function y(e,n={}){const t=function(...n){return d=t,e(...n)};return n.lazy||t(),t.options=n,t}function g(e,n){let t=h.get(e);t||h.set(e,t=new Map);let o=t.get(n);o||t.set(n,o=new Set),o.has(d)||o.add(d)}function E(e,n){const t=h.get(e);if(!t)return;const o=new Set;t.get(n).forEach(e=>o.add(e)),o.forEach(e=>function(e){void 0!==e.options.scheduler?e.options.scheduler(e):e()}(e))}function T(e,n){e.innerText=n}function R(e,n,t,o){switch(n){case"id":case"tId":null==o?e.removeAttribute(n):e.setAttribute(n,o);break;case"class":e.setAttribute("class",o);break;case"onClick":e.addEventListener("click",o)}}function N(e,n,t=null){t?n.insertBefore(e,t):n.appendChild(e)}function A(e){const n=e.parentNode;n&&n.removeChild(e)}function v(e,n){return e.type===n.type&&e.key===n.key}function k(e,n,o){const{shapeFlag:l,children:c}=e,{shapeFlag:r,children:u}=n;r&t.TEXT_CHILDREN?u!==c&&T(o,u):l&t.ARRAY_CHILDREN&&r&t.ARRAY_CHILDREN&&function(e,n,t){let o=0,l=e.length-1,c=n.length-1;for(;o<=l&&o<=c;){const l=e[o],c=n[o];if(!v(l,c)){console.log("两个 child 不相等(从左往右比对)");break}console.log("两个 child 相等，接下来对比着两个 child 节点(从左往右比对)"),patch(l,c,t),o++}for(;o<=l&&o<=c;){const o=e[l],r=n[c];if(!v(o,r)){console.log("两个 child 不相等(从右往左比对)");break}console.log("两个 child 相等，接下来对比着两个 child 节点(从右往左比对)"),patch(o,r,t),l--,c--}if(o>l&&o<=c)for(;o<=c;)console.log("需要新创建一个 vnode: "+n[o].key),patch(null,n[o],t),o++;else if(o>c&&o<=l)for(;o<=l;)console.log("需要删除当前的 vnode: "+e[o].key),A(e[o].el),o++;else{let r=o,u=o;const s=new Map;for(let e=u;e<=c;e++){const t=n[e];s.set(t.key,e)}const i=new Array(c-u+1);for(let e=0;e<i.length;e++)i[e]=-1;for(o=r;o<=l;o++){const l=e[o],c=s.get(l.key);i[c]=o,void 0===c?A(l.el):(console.log("新老节点都存在"),patch(l,n[c],t))}for(o=c;o>=u;o--){const e=n[o];if(-1===i[o])patch(null,n[o],t);else{const l=o+1>=c+1?null:n[o+1];N(e.el,t,l&&l.el)}}}}(c,u,o)}function b(){console.log("beforeMount")}function C(){console.log("mounted")}const L=(e,n)=>{_(null,e,n)};function _(e,n,o=null){const{type:l,shapeFlag:c}=n;switch(l){case"text":break;default:c&t.ELEMENT?function(e,n,o){e?function(e,n,t){const o=e&&e.props||{},l=n.props||{},c=n.el=e.el;(function(e,n,t){for(const o in t){const l=n[o],c=t[o];l!==c&&R(e,o,0,c)}for(const o in n){n[o];const l=null;o in t||R(e,o,0,l)}})(c,o,l),k(e,n,c)}(e,n):function(e,n){const{shapeFlag:o,props:l}=e,c=e.el=(r=e.type,document.createElement(r));var r;o&t.TEXT_CHILDREN?T(c,e.children):o&t.ARRAY_CHILDREN&&function(e,n){e.forEach(e=>{console.log("mountChildren:",e),_(null,e,n)})}(e.children,c);if(l)for(const e in l){const n=l[e];R(c,e,0,n)}N(c,n)}(n,o)}(e,n,o):c&t.STATEFUL_COMPONENT&&function(e,n,t){e||function(e,n){const t=e.component=(o=e,{type:o.type,vnode:o,props:{},proxy:null,isMounted:!1});var o;(function(e){!function(e){const{setup:n,render:t}=e.type,o=n&&n(e.props);e.proxy=o,e.render=t}(e)})(t),function(e,n){e.update=y((function(){if(e.isMounted){const n=e.render(e.proxy),t=e.subTree;e.subTree=n,b(),_(t,n,t.el),C()}else{const t=e.subTree=e.render(e.proxy);b(),_(null,t,n),C(),e.isMounted=!0}}),{scheduler:e=>{a(e)}})}(t,n)}(n,t)}(e,n,o)}}e.computed=function(e){let n,t,o=!0;const l=y(e,{lazy:!0,scheduler:e=>{o||(o=!0,E(t,"value"))}});return t={get value(){return o&&(n=l(),o=!1),g(t,"value"),n}},t},e.createApp=(e,n=null)=>{const t={mount(o){const l=r(e,n);t._container=o,L(l,o)}};return t},e.createBlock=function(e,n,t,o,u){const s=r(e,n,t,o,u,!0);return s.dynamicChildren=c||EMPTY_ARR,l.pop(),c=l[l.length-1]||null,c&&c.push(s),s},e.createTextVNode=function(e=" ",t=0){return r(n,null,e,t)},e.createVNode=r,e.effect=y,e.nextTick=f,e.openBlock=(e=!1)=>{l.push(c=e?null:[])},e.queueJob=a,e.reactive=function(e){return new Proxy(e,{get:(e,n)=>(g(e,n),Reflect.get(e,n)),set:(e,n,t)=>(Reflect.set(e,n,t),E(e,n),!0)})},e.ref=function(e){let n=e;const t={get value(){return g(t,"value"),n},set value(e){e!==n&&(n=e,E(t,"value"))}};return t},e.render=L,e.toDisplayString=e=>null==e?"":(e=>null!==e&&"object"==typeof e)(e)?JSON.stringify(e,replacer,2):String(e),Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=uuz.js.map
